importScripts("fuse.min.js"),importScripts("Rx.min.js"),importScripts("SearchEngine.js");var BUFFER_COUNT=400,BUFFER_INTERVAL=1e3,resultSubscription=new Rx.BehaviorSubject(null),resultStreamSource=new Rx.Subject,newInterval=Rx.Observable.from(Rx.Observable.interval(100)),resultStream=resultStreamSource["switch"]().zip(Rx.Observable.interval(BUFFER_INTERVAL),function(e,s){return e}).map(function(e){return e.filter(function(e){return e.hasOwnProperty("uid")})}),sendMessage=function(e,s){messageSubj.next({type:e,value:s})},sendResults=function(e){sendMessage(MessageType.resultCount,e.length),sendMessage(MessageType.resultAll,e)},messageSubj=Rx.Subject.create().debounceTime(35).subscribe(function(e){return self.postMessage(e)}),se;self.onerror=function(e){return console.error(e)};var messageEventHandler=function(e){var s=e.data;if(s.type===MessageType.data||void 0!==se){var r=function(e){switch(e){case"data":se=new SearchEngine(s.value),r("eventrange");break;case"info":var n=s.value,t=se.getInfoById(n);void 0!==t&&sendMessage(MessageType.info,t);break;case"query":try{var a=s.value,u=se.getResultsByTerm(a);sendResults(u)}catch(o){console.error("fromWorker",o)}break;case"queryTime":var i=s.value,c=se.eventResultsAtTime(i);sendResults(c);break;case"eventrange":sendMessage(MessageType.eventrange,se.eventRange);break;default:console.error("Unknown message type "+s.type+" received by search-engine-worker.js",s)}};r(s.type)}};self.onmessage=function(e){return messageEventHandler(e)};